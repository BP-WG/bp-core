{-
  Id: urn:ubideco:stl:9pKFs7Gw7gwerYGVcPCDqiCv5fa165qC6PvFxiotJjaG#rebel-herbert-tourist
  Name: BPCore
  Version: 0.1.0
  Description: Bitcoin client-side-validation library
  Author: Dr Maxim Orlovsky <orlovsky@lnp-bp.org>
  Copyright (C) 2023-2024 LNP/BP Standards Association. All rights reserved.
  License: Apache-2.0
-}

@context
typelib BPCore

import CommitVerify#7EpM1uymEteG4g4xmF5ntKYX1wXXpbQj5iLiDreH4jWa#protein-donald-cool
  use MerkleTree#side-locate-bonus
  use ProtocolId#gamma-banjo-corona
  use Message#shampoo-bishop-morgan
  use MerkleHash#culture-metro-modular
  use MerkleBlock#miracle-antenna-moral
  use MerkleProof#labor-hilton-magenta
  use ReservedBytes1#joker-lemon-mental
  use TreeNode#risk-opinion-orca

import Std#DzTvt9gGhPUKD8Dkkjk9PDBhkJ4gtWxXWQjxnmUYLNrs#voyage-kimono-disco
  use U5#nitro-george-nebula

import Bitcoin#HX2UBak8vPsTokug1DGMDvTpzns3xUdwZ7QJdyt4qBA9#speed-atlanta-trilogy
  use Vout#chrome-robin-gallop
  use ScriptBytes#maestro-source-jackson
  use TapNodeHash#crash-culture-jamaica
  use LeafScript#brenda-round-micro
  use Txid#cowboy-diego-betty
  use InternalPk#meter-nerve-chicken
  use LeafVer#tunnel-lagoon-cowboy
  use XOnlyPk#evident-finance-promo


@mnemonic(marvin-austin-fame)
data AnchorMerkleBlockOpretProof : reserved1 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , reserved2 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , mpcProof CommitVerify.MerkleBlock#miracle-antenna-moral
                       , dbcProof OpretProof

@mnemonic(bottle-mozart-mimosa)
data AnchorMerkleBlockTapretProof : reserved1 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , reserved2 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , mpcProof CommitVerify.MerkleBlock#miracle-antenna-moral
                       , dbcProof TapretProof

@mnemonic(flag-center-weather)
data AnchorMerkleProofOpretProof : reserved1 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , reserved2 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , mpcProof CommitVerify.MerkleProof#labor-hilton-magenta
                       , dbcProof OpretProof

@mnemonic(camel-mentor-taboo)
data AnchorMerkleProofTapretProof : reserved1 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , reserved2 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , mpcProof CommitVerify.MerkleProof#labor-hilton-magenta
                       , dbcProof TapretProof

@mnemonic(clock-bazooka-cadet)
data AnchorMerkleTreeOpretProof : reserved1 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , reserved2 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , mpcProof CommitVerify.MerkleTree#side-locate-bonus
                       , dbcProof OpretProof

@mnemonic(vacuum-fluid-acid)
data AnchorMerkleTreeTapretProof : reserved1 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , reserved2 CommitVerify.ReservedBytes1#joker-lemon-mental
                       , mpcProof CommitVerify.MerkleTree#side-locate-bonus
                       , dbcProof TapretProof

@mnemonic(explore-aspect-ranger)
data BlindSealTxPtr    : method Method
                       , txid TxPtr
                       , vout Bitcoin.Vout#chrome-robin-gallop
                       , blinding U64

@mnemonic(prepare-pluto-cactus)
data BlindSealTxid     : method Method
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , vout Bitcoin.Vout#chrome-robin-gallop
                       , blinding U64

@mnemonic(british-aloha-mimosa)
data ExplicitSealTxPtr : method Method
                       , txid TxPtr
                       , vout Bitcoin.Vout#chrome-robin-gallop

@mnemonic(think-convert-temple)
data ExplicitSealTxid  : method Method
                       , txid Bitcoin.Txid#cowboy-diego-betty
                       , vout Bitcoin.Vout#chrome-robin-gallop

@mnemonic(trilogy-tahiti-valid)
data Method            : opretFirst | tapretFirst


@mnemonic(segment-ambient-totem)
data OpretProof        : ()

@mnemonic(santana-domingo-needle)
data SecretSeal        : [Byte ^ 32]

@mnemonic(tribal-voltage-object)
data TapretNodePartner : leftNode Bitcoin.TapNodeHash#crash-culture-jamaica
                       | rightLeaf Bitcoin.LeafScript#brenda-round-micro
                       | rightBranch TapretRightBranch

@mnemonic(clark-magic-salon)
data TapretPathProof   : partnerNode TapretNodePartner?, nonce U8

@mnemonic(aurora-bonjour-dinner)
data TapretProof       : pathProof TapretPathProof, internalPk Bitcoin.InternalPk#meter-nerve-chicken

@mnemonic(basket-prelude-bridge)
data TapretRightBranch : leftNodeHash Bitcoin.TapNodeHash#crash-culture-jamaica, rightNodeHash Bitcoin.TapNodeHash#crash-culture-jamaica

@mnemonic(strange-source-father)
data TxPtr             : witnessTx ()
                       | txid Bitcoin.Txid#cowboy-diego-betty


